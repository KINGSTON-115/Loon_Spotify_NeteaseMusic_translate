#!name = è§£é”&ç¿»è¯‘&å»å¹¿å‘Š(Charlesä¿®æ”¹ç‰ˆ)
#!desc = å°†Spotifyçš„å¤–è¯­æ­Œè¯ç¿»è¯‘ä¸ºç®€ä½“ä¸­æ–‡ï¼ˆç½‘æ˜“äº‘éŸ³ä¹ï¼‰
#!openUrl = 
#!author =CharlesLeon[https://DualSubs.github.io/guide/spotify]
#!homepage = https://github.com/KINGSTON-115
#!icon = https://github.com/Moli-X/Resources/raw/main/Icon/Image/Spotify.png
#!Edit = https://github.com/Moli-X/Resources/edit/main/Loon/Spotify/Spotify.plugin

# åŸé“¾æ¥ï¼šhttps://raw.githubusercontent.com/app2smile/rules/master/plugin/spotify.plugin
# åŸé“¾æ¥: https://github.com/DualSubs/Spotify/releases/latest/download/DualSubs.Spotify.plugin
# åŸé“¾æ¥ï¼šhttps://DualSubs.github.io/guide/spotify

[Rewrite]
^https:\/\/spclient\.wg\.spotify\.com\/user-customization-service\/v1\/customize$ header-del if-none-match

[Mitm]
hostname =spclient.wg.spotify.com

[Script]
http-request ^https:\/\/spclient\.wg\.spotify\.com\/(artistview\/v1\/artist|album-entity-view\/v2\/album)\/ script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/spotify-json.js, timeout=10, tag=spotifyJson
http-response ^https:\/\/spclient\.wg\.spotify\.com\/(bootstrap\/v1\/bootstrap|user-customization-service\/v1\/customize)$ script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/spotify-proto.js, requires-body=true, binary-body-mode=true, timeout=10, tag=spotifyProto

# å¤„ç†æ­Œæ›²ä¿¡æ¯
http-response ^https?:\/\/api\.spotify\.com\/v1\/tracks\? requires-body=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.9/response.bundle.js, tag=ğŸ¿ï¸ å¤„ç†æ­Œæ›²ä¿¡æ¯

# æ­Œè¯è¯·æ±‚å¤„ç†
http-request ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json requires-body=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.9/request.bundle.js, tag=ğŸ¿ï¸ è¯·æ±‚ç½‘æ˜“äº‘æ­Œè¯

http-request ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*) requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.9/request.bundle.js, tag=ğŸ¿ï¸ è¯·æ±‚ç½‘æ˜“äº‘æ­Œè¯(Protobuf)

# ç¿»è¯‘å¤„ç†ï¼ˆä½¿ç”¨ç½‘æ˜“äº‘è‡ªå¸¦ç¿»è¯‘ï¼‰
http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json(.*)subtype=Translate requires-body=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=ğŸ¿ï¸ æå–ç½‘æ˜“äº‘è‡ªå¸¦ç¿»è¯‘

http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*)subtype=Translate requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=ğŸ¿ï¸ æå–ç½‘æ˜“äº‘è‡ªå¸¦ç¿»è¯‘(Protobuf)

# å¤–éƒ¨æ­Œè¯å“åº”å¤„ç†
http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json(.*)subtype=External requires-body=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=ğŸ¿ï¸ æ˜¾ç¤ºç½‘æ˜“äº‘æ­Œè¯

http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*)subtype=External requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=ğŸ¿ï¸ æ˜¾ç¤ºç½‘æ˜“äº‘æ­Œè¯(Protobuf)


[MITM]
hostname = api.spotify.com, spclient.wg.spotify.com